generator client {
    provider      = "prisma-client"
    output        = "../src/generated/prisma-client"
    moduleFormat  = "cjs"
    binaryTargets = ["native", "debian-openssl-1.1.x"]
}

datasource db {
    provider = "postgresql"
}

enum VideoStatus {
    UPLOADING // post-create → đang upload qua tusd
    UPLOADED // post-finish → file đã nằm trong MinIO
    PROCESSING // đang encode / transcode / thumbnail
    READY // encode xong, có thể xem
    FAILED // lỗi (upload hoặc processing)
    DELETED // user hoặc hệ thống xoá
}

model Video {
    id            String      @id
    storageBucket String
    storageKey    String
    size          Int
    userId        String
    filetype      String
    status        VideoStatus @default(UPLOADING)

    createdById String?
    updatedById String?
    deletedById String?

    deletedAt DateTime?
    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt

    @@index([deletedAt])
    @@index([userId])
    @@index([status])
    @@index([storageKey])
}
